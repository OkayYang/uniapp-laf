{"version":3,"sources":["webpack:///C:/Users/XuShiPing/Desktop/uniapp-laf-main/uni_modules/uview-ui/components/u-form/u-form.vue?f2be","webpack:///C:/Users/XuShiPing/Desktop/uniapp-laf-main/uni_modules/uview-ui/components/u-form/u-form.vue?2f9b","webpack:///C:/Users/XuShiPing/Desktop/uniapp-laf-main/uni_modules/uview-ui/components/u-form/u-form.vue?2872","webpack:///C:/Users/XuShiPing/Desktop/uniapp-laf-main/uni_modules/uview-ui/components/u-form/u-form.vue?4fd7","uni-app:///uni_modules/uview-ui/components/u-form/u-form.vue"],"names":[],"mappings":";;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAA+H;AAC/H;AAC0D;AACL;;;AAGrD;AAC6L;AAC7L,gBAAgB,2LAAU;AAC1B,EAAE,4EAAM;AACR,EAAE,6FAAM;AACR,EAAE,sGAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,iGAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACtBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACRA;AAAA;AAAA;AAAA;AAAquB,CAAgB,srBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;ACOzvB;AACA,8G;AACA;AACA;AACA;;;;;;;;;;;;;;AAcA;AACA,gBADA;AAEA,wDAFA;AAGA,SAHA,qBAGA;AACA;AACA,iBADA;;AAGA,GAPA;AAQA,MARA,kBAQA;AACA;AACA,mBADA;AAEA;AACA,mBAHA;AAIA;AACA,yBALA;;AAOA,GAhBA;AAiBA;AACA;AACA;AACA,qBADA;AAEA,aAFA,mBAEA,CAFA,EAEA;AACA;AACA,OAJA,EAFA;;AAQA;AACA,eATA,uBASA,CATA,EASA;AACA;AACA;AACA;AACA;AACA,kCADA;AAEA,SAJA;AAKA;AACA,KAjBA;AAkBA;AACA;AACA,qBADA;AAEA,aAFA,mBAEA,CAFA,EAEA;AACA;AACA;AACA;AACA,OANA,EAnBA,EAjBA;;;AA6CA;AACA,eADA,yBACA;AACA;AACA,oBADA;AAEA,uBAFA;AAGA,wBAHA;AAIA,qBAJA;AAKA,qBALA;AAMA,qBANA;;AAQA,KAVA,EA7CA;;AAyDA,SAzDA,qBAyDA;AACA;AACA;AACA;AACA,GA7DA;AA8DA;AACA;AACA,YAFA,oBAEA,KAFA,EAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAZA;AAaA;AACA,eAdA,yBAcA;AACA;AACA,KAhBA;AAiBA;AACA,cAlBA,sBAkBA,GAlBA,EAkBA;AACA;AACA;AACA;AACA;AACA;AACA,OAJA;AAKA,KAzBA;AA0BA;AACA,iBA3BA,yBA2BA,KA3BA,EA2BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OALA;AAMA,KAnCA;AAoCA;AACA,iBArCA,yBAqCA,KArCA,EAqCA,QArCA,EAqCA;;AAEA,mEAFA;AAGA,8DAHA;;;AAMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCADA;AAEA,gCAFA;;AAIA;AACA;AACA;AACA,6DADA;;AAGA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCADA,EACA,QADA;;AAGA;AACA,oCADA,EACA,WADA;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA,wCADA,kDACA,qBADA,yEACA,IADA;AAEA,yBAVA;;AAYA;AACA;AACA,mBA7CA;AA8CA;AACA;AACA,iBAtDA,EAPA;AA8DA,KAnGA;AAoGA;AACA,YArGA,oBAqGA,QArGA,EAqGA;AACA;AACA;AACA;AACA;AACA;AACA,6CADA;;AAGA;AACA;AACA;AACA;AACA;AACA,aAJA,MAIA;AACA;AACA;AACA,WARA;AASA,SAdA;AAeA,OAjBA;AAkBA,KAxHA,EA9DA,E","file":"uni_modules/uview-ui/components/u-form/u-form.js","sourcesContent":["import { render, staticRenderFns, recyclableRender, components } from \"./u-form.vue?vue&type=template&id=786a592e&scoped=true&\"\nvar renderjs\nimport script from \"./u-form.vue?vue&type=script&lang=js&\"\nexport * from \"./u-form.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"786a592e\",\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"uni_modules/uview-ui/components/u-form/u-form.vue\"\nexport default component.exports","export * from \"-!../../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--16-0!../../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./u-form.vue?vue&type=template&id=786a592e&scoped=true&\"","var components\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./u-form.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./u-form.vue?vue&type=script&lang=js&\"","<template>\n\t<view class=\"u-form\">\n\t\t<slot />\n\t</view>\n</template>\n\n<script>\n\timport props from \"./props.js\";\n\timport Schema from \"../../libs/util/async-validator\";\n\t// 去除警告信息\n\tSchema.warning = function() {};\n\t/**\n\t * Form 表单\n\t * @description 此组件一般用于表单场景，可以配置Input输入框，Select弹出框，进行表单验证等。\n\t * @tutorial https://www.uviewui.com/components/form.html\n\t * @property {Object}\t\t\t\t\t\tmodel\t\t\t当前form的需要验证字段的集合\n\t * @property {Object | Function | Array}\trules\t\t\t验证规则\n\t * @property {String}\t\t\t\t\t\terrorType\t\t错误的提示方式，见上方说明 ( 默认 message )\n\t * @property {Boolean}\t\t\t\t\t\tborderBottom\t是否显示表单域的下划线边框   ( 默认 true ）\n\t * @property {String}\t\t\t\t\t\tlabelPosition\t表单域提示文字的位置，left-左侧，top-上方 ( 默认 'left' ）\n\t * @property {String | Number}\t\t\t\tlabelWidth\t\t提示文字的宽度，单位px  ( 默认 45 ）\n\t * @property {String}\t\t\t\t\t\tlabelAlign\t\tlable字体的对齐方式   ( 默认 ‘left' ）\n\t * @property {Object}\t\t\t\t\t\tlabelStyle\t\tlable的样式，对象形式\n\t * @example <u--formlabelPosition=\"left\" :model=\"model1\" :rules=\"rules\" ref=\"form1\"></u--form>\n\t */\n\texport default {\n\t\tname: \"u-form\",\n\t\tmixins: [uni.$u.mpMixin, uni.$u.mixin, props],\n\t\tprovide() {\n\t\t\treturn {\n\t\t\t\tuForm: this,\n\t\t\t};\n\t\t},\n\t\tdata() {\n\t\t\treturn {\n\t\t\t\tformRules: {},\n\t\t\t\t// 规则校验器\n\t\t\t\tvalidator: {},\n\t\t\t\t// 原始的model快照，用于resetFields方法重置表单时使用\n\t\t\t\toriginalModel: null,\n\t\t\t};\n\t\t},\n\t\twatch: {\n\t\t\t// 监听规则的变化\n\t\t\trules: {\n\t\t\t\timmediate: true,\n\t\t\t\thandler(n) {\n\t\t\t\t\tthis.setRules(n);\n\t\t\t\t},\n\t\t\t},\n\t\t\t// 监听属性的变化，通知子组件u-form-item重新获取信息\n\t\t\tpropsChange(n) {\n\t\t\t\tif (this.children?.length) {\n\t\t\t\t\tthis.children.map((child) => {\n\t\t\t\t\t\t// 判断子组件(u-form-item)如果有updateParentData方法的话，就就执行(执行的结果是子组件重新从父组件拉取了最新的值)\n\t\t\t\t\t\ttypeof child.updateParentData == \"function\" &&\n\t\t\t\t\t\t\tchild.updateParentData();\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t},\n\t\t\t// 监听model的初始值作为重置表单的快照\n\t\t\tmodel: {\n\t\t\t\timmediate: true,\n\t\t\t\thandler(n) {\n\t\t\t\t\tif (!this.originalModel) {\n\t\t\t\t\t\tthis.originalModel = uni.$u.deepClone(n);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t},\n\t\t},\n\t\tcomputed: {\n\t\t\tpropsChange() {\n\t\t\t\treturn [\n\t\t\t\t\tthis.errorType,\n\t\t\t\t\tthis.borderBottom,\n\t\t\t\t\tthis.labelPosition,\n\t\t\t\t\tthis.labelWidth,\n\t\t\t\t\tthis.labelAlign,\n\t\t\t\t\tthis.labelStyle,\n\t\t\t\t];\n\t\t\t},\n\t\t},\n\t\tcreated() {\n\t\t\t// 存储当前form下的所有u-form-item的实例\n\t\t\t// 不能定义在data中，否则微信小程序会造成循环引用而报错\n\t\t\tthis.children = [];\n\t\t},\n\t\tmethods: {\n\t\t\t// 手动设置校验的规则，如果规则中有函数的话，微信小程序中会过滤掉，所以只能手动调用设置规则\n\t\t\tsetRules(rules) {\n\t\t\t\t// 判断是否有规则\n\t\t\t\tif (Object.keys(rules).length === 0) return;\n\t\t\t\tif (process.env.NODE_ENV === 'development' && Object.keys(this.model).length === 0) {\n\t\t\t\t\tuni.$u.error('设置rules，model必须设置！如果已经设置，请刷新页面。');\n\t\t\t\t\treturn;\n\t\t\t\t};\n\t\t\t\tthis.formRules = rules;\n\t\t\t\t// 重新将规则赋予Validator\n\t\t\t\tthis.validator = new Schema(rules);\n\t\t\t},\n\t\t\t// 清空所有u-form-item组件的内容，本质上是调用了u-form-item组件中的resetField()方法\n\t\t\tresetFields() {\n\t\t\t\tthis.resetModel();\n\t\t\t},\n\t\t\t// 重置model为初始值的快照\n\t\t\tresetModel(obj) {\n\t\t\t\t// 历遍所有u-form-item，根据其prop属性，还原model的原始快照\n\t\t\t\tthis.children.map((child) => {\n\t\t\t\t\tconst prop = child?.prop;\n\t\t\t\t\tconst value = uni.$u.getProperty(this.originalModel, prop);\n\t\t\t\t\tuni.$u.setProperty(this.model, prop, value);\n\t\t\t\t});\n\t\t\t},\n\t\t\t// 清空校验结果\n\t\t\tclearValidate(props) {\n\t\t\t\tprops = [].concat(props);\n\t\t\t\tthis.children.map((child) => {\n\t\t\t\t\t// 如果u-form-item的prop在props数组中，则清除对应的校验结果信息\n\t\t\t\t\tif (props[0] === undefined || props.includes(child.prop)) {\n\t\t\t\t\t\tchild.message = null;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\t\t\t// 对部分表单字段进行校验\n\t\t\tasync validateField(value, callback, event = null) {\n\t\t\t\t// 开发环境才提示，生产环境不会提示\n\t\t\t\tif (process.env.NODE_ENV === 'development' && Object.keys(this.formRules).length === 0) {\n\t\t\t\t\tuni.$u.error('未设置rules，请看文档说明！如果已经设置，请刷新页面。');\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\t// $nextTick是必须的，否则model的变更，可能会延后于此方法的执行\n\t\t\t\tthis.$nextTick(() => {\n\t\t\t\t\t// 校验错误信息，返回给回调方法，用于存放所有form-item的错误信息\n\t\t\t\t\tconst errorsRes = [];\n\t\t\t\t\t// 如果为字符串，转为数组\n\t\t\t\t\tvalue = [].concat(value);\n\t\t\t\t\t// 历遍children所有子form-item\n\t\t\t\t\tthis.children.map((child) => {\n\t\t\t\t\t\t// 用于存放form-item的错误信息\n\t\t\t\t\t\tconst childErrors = [];\n\t\t\t\t\t\tif (value.includes(child.prop)) {\n\t\t\t\t\t\t\t// 获取对应的属性，通过类似'a.b.c'的形式\n\t\t\t\t\t\t\tconst propertyVal = uni.$u.getProperty(\n\t\t\t\t\t\t\t\tthis.model,\n\t\t\t\t\t\t\t\tchild.prop\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t// 属性链数组\n\t\t\t\t\t\t\tconst propertyChain = child.prop.split(\".\");\n\t\t\t\t\t\t\tconst propertyName =\n\t\t\t\t\t\t\t\tpropertyChain[propertyChain.length - 1];\n\n\t\t\t\t\t\t\tconst rule = this.formRules[child.prop];\n\t\t\t\t\t\t\t// 如果不存在对应的规则，直接返回，否则校验器会报错\n\t\t\t\t\t\t\tif (!rule) return;\n\t\t\t\t\t\t\t// rule规则可为数组形式，也可为对象形式，此处拼接成为数组\n\t\t\t\t\t\t\tconst rules = [].concat(rule);\n\n\t\t\t\t\t\t\t// 对rules数组进行校验\n\t\t\t\t\t\t\tfor (let i = 0; i < rules.length; i++) {\n\t\t\t\t\t\t\t\tconst ruleItem = rules[i];\n\t\t\t\t\t\t\t\t// 将u-form-item的触发器转为数组形式\n\t\t\t\t\t\t\t\tconst trigger = [].concat(ruleItem?.trigger);\n\t\t\t\t\t\t\t\t// 如果是有传入触发事件，但是此form-item却没有配置此触发器的话，不执行校验操作\n\t\t\t\t\t\t\t\tif (event && !trigger.includes(event)) continue;\n\t\t\t\t\t\t\t\t// 实例化校验对象，传入构造规则\n\t\t\t\t\t\t\t\tconst validator = new Schema({\n\t\t\t\t\t\t\t\t\t[propertyName]: ruleItem,\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\tvalidator.validate({\n\t\t\t\t\t\t\t\t\t\t[propertyName]: propertyVal,\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t(errors, fields) => {\n\t\t\t\t\t\t\t\t\t\tif (uni.$u.test.array(errors)) {\n\t\t\t\t\t\t\t\t\t\t\terrorsRes.push(...errors);\n\t\t\t\t\t\t\t\t\t\t\tchildErrors.push(...errors);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tchild.message =\n\t\t\t\t\t\t\t\t\t\t\tchildErrors[0]?.message ?? null;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\t// 执行回调函数\n\t\t\t\t\ttypeof callback === \"function\" && callback(errorsRes);\n\t\t\t\t});\n\t\t\t},\n\t\t\t// 校验全部数据\n\t\t\tvalidate(callback) {\n\t\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\t\t// $nextTick是必须的，否则model的变更，可能会延后于validate方法\n\t\t\t\t\tthis.$nextTick(() => {\n\t\t\t\t\t\t// 获取所有form-item的prop，交给validateField方法进行校验\n\t\t\t\t\t\tconst formItemProps = this.children.map(\n\t\t\t\t\t\t\t(item) => item.prop\n\t\t\t\t\t\t);\n\t\t\t\t\t\tthis.validateField(formItemProps, (errors) => {\n\t\t\t\t\t\t\tif(errors.length) {\n\t\t\t\t\t\t\t\t// 如果错误提示方式为toast，则进行提示\n\t\t\t\t\t\t\t\tthis.errorType === 'toast' && uni.$u.toast(errors[0].message)\n\t\t\t\t\t\t\t\treject(errors)\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tresolve(true)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t},\n\t\t},\n\t};\n</script>\n\n<style lang=\"scss\" scoped>\n</style>\n"],"sourceRoot":""}