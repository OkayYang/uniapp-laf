(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/detail/detail"],{"0d41":function(t,n,e){},"48d2":function(t,n,e){"use strict";e.r(n);var o=e("d873"),i=e.n(o);for(var u in o)"default"!==u&&function(t){e.d(n,t,(function(){return o[t]}))}(u);n["default"]=i.a},"4c9a":function(t,n,e){"use strict";e.r(n);var o=e("a229"),i=e("48d2");for(var u in i)"default"!==u&&function(t){e.d(n,t,(function(){return i[t]}))}(u);e("5d49");var a,s=e("f0c5"),l=Object(s["a"])(i["default"],o["b"],o["c"],!1,null,null,null,!1,o["a"],a);n["default"]=l.exports},"5d49":function(t,n,e){"use strict";var o=e("0d41"),i=e.n(o);i.a},a229:function(t,n,e){"use strict";e.d(n,"b",(function(){return i})),e.d(n,"c",(function(){return u})),e.d(n,"a",(function(){return o}));var o={uAvatar:function(){return Promise.all([e.e("common/vendor"),e.e("uni_modules/uview-ui/components/u-avatar/u-avatar")]).then(e.bind(null,"8950"))},uTag:function(){return Promise.all([e.e("common/vendor"),e.e("uni_modules/uview-ui/components/u-tag/u-tag")]).then(e.bind(null,"d543"))},uReadMore:function(){return Promise.all([e.e("common/vendor"),e.e("uni_modules/uview-ui/components/u-read-more/u-read-more")]).then(e.bind(null,"459a"))},uLine:function(){return Promise.all([e.e("common/vendor"),e.e("uni_modules/uview-ui/components/u-line/u-line")]).then(e.bind(null,"472f"))},uEmpty:function(){return Promise.all([e.e("common/vendor"),e.e("uni_modules/uview-ui/components/u-empty/u-empty")]).then(e.bind(null,"2046"))},uToast:function(){return e.e("uni_modules/uview-ui/components/u-toast/u-toast").then(e.bind(null,"c41c"))},uPopup:function(){return Promise.all([e.e("common/vendor"),e.e("uni_modules/uview-ui/components/u-popup/u-popup")]).then(e.bind(null,"d857"))},uTabbar:function(){return Promise.all([e.e("common/vendor"),e.e("uni_modules/uview-ui/components/u-tabbar/u-tabbar")]).then(e.bind(null,"d249"))},tuiModal:function(){return e.e("node-modules/thorui-uni/lib/thorui/tui-modal/tui-modal").then(e.bind(null,"e2df"))},uSearch:function(){return Promise.all([e.e("common/vendor"),e.e("uni_modules/uview-ui/components/u-search/u-search")]).then(e.bind(null,"bfce"))},tuiButton:function(){return e.e("node-modules/thorui-uni/lib/thorui/tui-button/tui-button").then(e.bind(null,"9b82"))}},i=function(){var t=this,n=t.$createElement;t._self._c;t._isMounted||(t.e0=function(n){n.stopPropagation(),t.isPopup=!1},t.e1=function(n){t.renling.reShow=!0},t.e2=function(n){t.loginPane.show=!1})},u=[]},ae51:function(t,n,e){"use strict";(function(t){e("c83d");o(e("66fd"));var n=o(e("4c9a"));function o(t){return t&&t.__esModule?t:{default:t}}wx.__webpack_require_UNI_MP_PLUGIN__=e,t(n.default)}).call(this,e("543d")["createPage"])},d873:function(t,n,e){"use strict";(function(t){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var o=u(e("9e94")),i=u(e("6cac"));function u(t){return t&&t.__esModule?t:{default:t}}var a=function(){e.e("components/thorui/tui-button/tui-button").then(function(){return resolve(e("d17a"))}.bind(null,e)).catch(e.oe)},s=function(){e.e("components/thorui/tui-modal/tui-modal").then(function(){return resolve(e("f69d"))}.bind(null,e)).catch(e.oe)},l=function(){e.e("components/thorui/tui-dropdown-list/tui-dropdown-list").then(function(){return resolve(e("8300"))}.bind(null,e)).catch(e.oe)},c={components:{tuiButton:a,tuiDropdownList:l,tuiModal:s},data:function(){return{baseUrl:i.default.getHost(),author:{uid:null,avatar:null,nickName:null},comments:[],info:null,input:{uid:null,cid:1e3,commented:null,msg:"",commentIcon:"",isUpload:!1,uploadPath:"",focus:!1,placeholder:"请发送一条友善的评论",mainComment:null,acceptPeople:null},delete:{id:""},option:"",tid:"",category:[],shadowStyle:{backgroundImage:"none",paddingTop:"0",marginTop:"20rpx"},timeout:0,isPopup:!1,renling:{show:!1,reShow:!1,button:[{text:"取消",type:"red",plain:!0},{text:"确定",type:"red"}]},loginPane:{show:!1},emptyComment:{text:" "}}},onLoad:function(t){this.reload(t)},onShareAppMessage:function(t){return"button"===t.from&&console.log(t.target),{title:"页面详细",path:"../message/message?tid=1"}},onPullDownRefresh:function(){this.reload(this.option)},methods:{reload:function(n){var e=this;this.option=n,this.tid=n.tid,this.category=[],i.default.getRequest("/wx/api/category/treeData",null,(function(t){t.data.forEach((function(t){e.category.push(t.name)}))})),null==this.author.uid&&t.getStorage({key:"userInfo",success:function(t){e.author.uid=t.data.stuId,e.author.avatar=t.data.stuImage,e.author.nickName=t.data.stuNick}}),i.default.getRequest("/wx/api/info/list",{relId:this.tid},(function(t){var n=t.data;e.info=n})),this.getCommentList(this.tid)},clear:function(){this.input.msg=""},uploadPicture:function(){var n=this;t.chooseImage({count:1,sizeType:["original"],sourceType:["album"],success:function(t){n.input.uploadPath=t.tempFilePaths[0],n.input.isUpload=!0}})},cancelUpload:function(){this.input.isUpload=!1},previewImage:function(n){t.previewImage({urls:[n]})},changeGood:function(t){t.isGood?t.goodNum--:t.goodNum++,t.isGood=!t.isGood},comment:function(){var n=this;if(this.isLogin())if(this.input.msg.length<1&&!this.input.isUpload)this.$refs.uToast.show({type:"default",message:"评论不能为空!",iconUrl:"https://cdn.uviewui.com/uview/demo/toast/error.png"});else{var e=this,u=new Date,a=((0,o.default)(u),null);this.input.isUpload?t.uploadFile({url:e.baseUrl+"/wx/api/info/upload",filePath:e.input.uploadPath,name:"file",success:function(t){a=t.data,console.log(e.input),i.default.postRequest("/wx/api/info/auth/comment/add",{comRelId:e.tid,comContent:e.input.msg,parentId:e.input.acceptPeople,comImage:a},(function(t){i.default.getRequest("/wx/api/info/test?relId="+n.tid,null,(function(t){e.comments=t.data})),n.$refs.uToast.show({type:"success",message:"发布评论成功",duration:700,iconUrl:"https://cdn.uviewui.com/uview/demo/toast/success.png"}),n.input.msg="",n.input.isUpload=!1,n.input.focus=!1,n.input.mainComment=null,n.input.acceptPeople=null,n.input.cid++,n.input.placeholder="请发送一条友善的评论"}))}}):i.default.postRequest("/wx/api/info/auth/comment/add",{comRelId:e.tid,comContent:e.input.msg,parentId:e.input.acceptPeople,comImage:a},(function(t){i.default.getRequest("/wx/api/info/test?relId="+n.tid,null,(function(t){e.comments=t.data})),n.$refs.uToast.show({type:"success",message:"发布评论成功",duration:700,iconUrl:"https://cdn.uviewui.com/uview/demo/toast/success.png"}),n.input.msg="",n.input.isUpload=!1,n.input.focus=!1,n.input.mainComment=null,n.input.acceptPeople=null,n.input.cid++,n.input.placeholder="请发送一条友善的评论"}))}else this.loginPane.show=!0},replyInfo:function(t,n){this.input.focus=!0,this.input.placeholder="回复:"+t.comm_user.nickName,this.input.mainComment=t,this.input.acceptPeople=n},blur:function(){this.input.msg="",this.input.isUpload=!1,this.input.focus=!1,this.input.mainComment=null,this.input.acceptPeople=null,this.input.placeholder="请发送一条友善的评论"},judgeComment:function(t,n){var e;return this.comments.forEach((function(n){n.cid==t.pid&&(e=t.name)})),void 0===e&&n.forEach((function(n){n.cid==t.pid&&(e=n.name)})),e},touchend:function(t,n){clearTimeout(this.timeout),t.comment.comStar="#f3f3f3;",this.timeout<700&&this.replyInfo(t,n)},touchstart:function(t,n){var e=this;e.timeout=0,t.comm_user.uid===e.author.uid&&(clearTimeout(e.timeout),t.comment.comStar="#cbcbcb",e.timeout=setTimeout((function(){e.longClick(n),e.timeout=701}),700))},touchmove:function(){clearTimeout(this.timeout),this.timeout=701},longClick:function(t){this.isPopup=!0,this.delete.id=t},deleteComment:function(){var t=this;i.default.getRequest("/wx/api/info/auth/comment/delete?id="+this.delete.id,null,(function(n){i.default.getRequest("/wx/api/info/test?relId="+t.tid,null,(function(n){t.comments=n.data,t.isPopup=!1}))}))},accept:function(){this.isLogin()?this.renling.show=!0:this.loginPane.show=!0},acceptClick:function(t){var n=this;0==t.index?this.renling.show=!1:i.default.getRequest("/wx/api/info/auth/claim?relId="+this.tid,null,(function(t){n.renling.show=!1,n.$refs.uToast.show({type:"success",message:"认领成功",duration:700,iconUrl:"https://cdn.uviewui.com/uview/demo/toast/success.png"}),n.reload(n.option)}))},getCommentList:function(t){var n=this;i.default.getRequest("/wx/api/info/test",{relId:t},(function(t){var e=t.data;n.comments=e}))},doComment:function(){this.input.focus=!0},isLogin:function(){return null!==this.author.uid},login:function(){t.switchTab({url:"../user/user"})},cancelAccept:function(t){var n=this;0==t.index?this.renling.reShow=!1:(this.renling.reShow=!1,i.default.getRequest("/wx/api/info/auth/unClaim?relId="+this.tid,null,(function(t){n.reload(n.option)})))}}};n.default=c}).call(this,e("543d")["default"])}},[["ae51","common/runtime","common/vendor"]]]);